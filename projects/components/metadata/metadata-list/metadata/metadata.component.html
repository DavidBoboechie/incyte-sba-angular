<ng-container *ngIf="display">
    <!-- Icon -->
    <span *ngIf="showIcon" class="sq-metadata-col {{config.icon}} pe-2"></span>

    <!-- Title -->
    <span *ngIf="showTitle" class="sq-metadata-col sq-metadata-item-label pe-2">
        {{'msg#metadata.item.label' | sqMessage:itemLabelMessageParams}}
    </span>

    <!-- Value -->
    <div class="sq-metadata-col" sqPopper [target]="isClickable ? tooltip : undefined" [placement]="placement">
        <ng-container *ngIf="config.isTree; else isNotTree">
            <sq-metadata-tree [record]="record" [config]="config" [clickable]="isClickable"
                [column]="config.column"></sq-metadata-tree>
        </ng-container>

        <!-- Not a Tree-->
        <ng-template #isNotTree>
            <span *ngFor="let valueItem of config.valueItems; let $index = index" [class.clickable]="isClickable"
                class="sq-metadata-item {{'sq-metadata-item-' + config.item}} me-1" (click)="select($index)"
                [attr.title]="(showTitle || config.entityTooltip) ? null : (label | sqMessage)"
                [sqTooltip]="config.entityTooltip" [sqTooltipData]="valueItem">
                <span *ngIf="showFormatIcon && valueIcon" class="{{valueIcon}}"></span>
                {{valueItem | sqValue:config.column}}
                <span *ngIf="showCounts && valueItem.count" class="counter rounded-pill bg-light text-black ms-1"
                    [title]="valueItem.count + ' occurrences in document'">{{valueItem.count}}</span>
            </span>
        </ng-template>
    </div>

    <div class="btn-group sq-metadata-btn" #tooltip>
        <button class="btn btn-primary" *ngIf="config.filterable">
            <span class="fas fa-filter"></span> Filter
        </button>
        <button class="btn btn-primary" *ngIf="config.excludable">
            <span class="fas fa-minus-circle"></span> Exclude
        </button>
    </div>
</ng-container>