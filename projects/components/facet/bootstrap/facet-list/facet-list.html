<div *ngIf="!isHidden()" class="list-group list-group-flush">

    <div *ngIf="searchBar" class="list-group-item border-0 p-1">
        <input [(ngModel)]='searchQuery' class="form-control" sqAutofocus
            placeholder="{{'msg#facet.searchPlaceholder' | sqMessage}}"
            (keyup)="search($event)"
            (ngModelChange)="suggest()">
    </div>

    <!--- suggestions items -->
    <ng-container *ngFor="let suggest of suggestions">
    <div (click)="filterItem(suggest, $event)" *ngIf="suggest.display"
        class="d-flex flex-row align-items-center list-group-item text-truncate border-0 list-group-item-action px-3 py-1 facet-row"
        [ngClass]="{'list-group-item-success': isFiltered(suggest)}">

        <a  href="#"
            role="button" title="{{suggest.display}}"
            class="text-truncate mr-auto">{{suggest | sqValue:suggest.$column}}</a>

        <span class="fa-stack" *ngIf="isFiltered(suggest)">
            <i class="ml-2 far fa-minus-square fa-stack-1x icons icon-hover"></i>
            <i class="ml-2 far fa-check-square fa-stack-1x icons icon-default"></i>
        </span>
        
    </div>
    <span *ngIf="!suggest.display" class="flex-grow-1 text-center text-muted small"><i>{{'msg#facet.searchNoResult' | sqMessage}}</i></span>
    </ng-container>

    <ng-container *ngIf="!hasSuggestions()">
        <!-- filtered items -->
        <div  *ngFor="let item of filtered"
            class="d-flex flex-row align-items-center list-group-item list-group-item-success text-truncate border-0 px-3 py-1 facet-row"
            title="{{ 'msg#facet.selectedValue' | sqMessage}}"
            (click)="filterItem(item, $event)">

            <a  href="#"
                class="text-truncate mr-auto">{{item | sqValue:item.$column}}</a>

            <span class="fa-stack">
                <i class="ml-2 far fa-minus-square fa-stack-1x icons icon-hover"></i>
                <i class="ml-2 far fa-check-square fa-stack-1x icons icon-default"></i>
            </span>
            <span *ngIf="showCount && item.count" class="text-muted small">{{item.count | sqNumber}}</span>

        </div>

        <!--- aggregation items without filtered -->
        <div *ngFor="let item of items" 
            class="d-flex flex-row align-items-center list-group-item list-group-item-action text-truncate border-0 px-3 py-1 facet-row"
            [ngClass]="{ 'list-group-item-primary':isSelected(item) }"
            title="{{ (isSelected(item) ? 'msg#facet.itemUnselect' : 'msg#facet.itemSelect') | sqMessage}}"
            (click)="selectItem(item)" href="#">

            <a  href="#" (click)="filterItem(item, $event)"
                title="{{ 'msg#facet.filterItem' | sqMessage:{'terme':(item | sqValue:item.$column)} }}"
                class="text-truncate mr-auto">{{item | sqValue:item.$column}}</a>

            <span *ngIf="showCount && item.count" class="ml-2 text-muted small">{{item.count | sqNumber}}</span>
        </div>

        <a  *ngIf="hasMore"
            class="list-group-item border-0 px-3 py-1 text-center"
            (click)="loadMore()" href="#">
            <span *ngIf="loadingMore" class="fas fa-sync fa-fw fa-spin"></span>
            <small *ngIf="!loadingMore">{{'msg#facet.loadMore' | sqMessage}}</small>
        </a>

    </ng-container>

</div>